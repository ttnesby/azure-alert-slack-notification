{
	log {
		format console
		level debug
	}
}

# http://localhost:8888 {
# 	route /transform/test* {
# 		az_alert_slack_notification
# 		respond {http.request.body}
# 	}
# }

http://localhost {
	#encode zstd gzip
	# rate_limit details
	# waf details

	route /transform/test* {
		az_alert_slack_notification
		# reverse_proxy http://localhost:8888 {
		# 	method PUT
		# 	@good status 2xx
		# 	handle_response @good {
		# 		# copy_response
		# 		# copy_response_headers
		# 		# reverse_proxy https://hooks.slack.com {
		# 		# 	header_up Host {upstream_hostport}
		# 		# 	method POST
		# 		# 	rewrite {$SLACK_TEST_NOTIFICATION}
		# 		# }
		# 	}
		# }
		#respond {http.request.body}
		reverse_proxy https://hooks.slack.com {
			header_up Host {upstream_hostport}
			rewrite {$SLACK_TEST_NOTIFICATION}
		}
	}

	handle /health* {
		respond "I'm fine" 200
	}
}
